# StrawHub

<p align="center">
  <a href="https://github.com/strawpot/strawhub/actions/workflows/ci.yml?branch=main"><img src="https://img.shields.io/github/actions/workflow/status/strawpot/strawhub/ci.yml?branch=main&style=for-the-badge" alt="CI"></a>
  <a href="https://discord.gg/buEbvEMC"><img src="https://img.shields.io/discord/1476285531464929505?label=Discord&logo=discord&logoColor=white&color=5865F2&style=for-the-badge" alt="Discord"></a>
  <a href="LICENSE"><img src="https://img.shields.io/badge/License-MIT-blue.svg?style=for-the-badge" alt="MIT License"></a>
</p>

StrawHub is the public role and skill registry for [StrawPot](https://strawpot.com): discover, publish, and install reusable roles and skills for StrawPot agents. 


Live: [`https://strawhub.dev`](https://strawhub.dev)

Following the same architecture as [ClawHub](https://clawhub.ai/), it extends the pattern to manage both **roles** and **skills** with recursive dependency resolution.

- **Skills** are markdown instruction modules that agents load into context — based on the [Agent Skills](https://agentskills.io/) open spec, extended with a `dependencies` frontmatter key
- **Roles** define agent behavior, default tools, model config, and dependent skills — follow the same markdown-with-frontmatter pattern, extended for agent configuration
- Skills can depend on other skills; roles depend on both skills and other roles
- Dependencies are resolved recursively on install

## Features

- **Browse & Search** — discover skills and roles with vector + lexical search
- **Publish** — upload SKILL.md / ROLE.md files via web UI or REST API
- **GitHub Import** — paste a GitHub repo URL to fetch and publish directly
- **Dashboard** — manage your published skills and roles
- **Settings** — edit profile (display name, bio), manage API tokens, delete account
- **Admin** — user management (role assignment, block/unblock), content reports
- **GitHub OAuth** — sign in with GitHub, avatar and @handle shown in nav
- **API Tokens** — create bearer tokens for CLI / programmatic access
- **Dependency Resolution** — roles declare skill dependencies resolved recursively on install

## Tech Stack

- **Frontend**: Vite + React 19 + TanStack Router + Tailwind CSS v4
- **Backend**: Convex (serverless DB + file storage + HTTP actions)
- **Auth**: GitHub OAuth via `@convex-dev/auth`
- **Search**: OpenAI embeddings + Convex vector search + lexical boosting
- **Analytics**: Vercel Analytics + Speed Insights
- **E2E Testing**: Playwright (Chromium)
- **Unit Testing**: Vitest
- **CI/CD**: GitHub Actions + Vercel (frontend) + Convex (backend)

## Development

### Prerequisites

- Node.js 22+
- A [Convex](https://convex.dev) project
- A [GitHub OAuth App](https://github.com/settings/developers)

### Setup

```bash
# Install dependencies
npm install

# Initialize Convex (first time only)
npx convex dev --once

# Generate JWT keys for Convex Auth
npx @convex-dev/auth setup
```

### Environment Variables

Set the following on your Convex deployment (via `npx convex env set` or the Convex dashboard):

| Variable | Description |
|----------|-------------|
| `AUTH_GITHUB_ID` | GitHub OAuth App client ID |
| `AUTH_GITHUB_SECRET` | GitHub OAuth App client secret |
| `SITE_URL` | Your app's public URL (e.g. `http://localhost:5173` for dev) |
| `CONVEX_SITE_URL` | Convex HTTP endpoint (e.g. `https://your-deployment.convex.site`) |
| `JWT_PRIVATE_KEY` | Generated by `npx @convex-dev/auth setup` |
| `JWKS` | Generated by `npx @convex-dev/auth setup` |
| `ADMIN_GITHUB_LOGINS` | Comma-separated GitHub logins with admin role (e.g. `woong,alice`) |

Local `.env.local` (created automatically by `npx convex dev`):

```
CONVEX_DEPLOYMENT=dev:your-deployment
VITE_CONVEX_URL=https://your-deployment.convex.cloud
VITE_CONVEX_SITE_URL=https://your-deployment.convex.site
```

### Run

```bash
# Start dev server (Convex + Vite concurrently)
npm run dev

# Type check
npm run typecheck
```

### Production Deployment

**Frontend** is deployed on [Vercel](https://vercel.com), auto-deploys on push to `main`.

Set `VITE_CONVEX_URL` in the Vercel dashboard (Settings > Environment Variables).

**Backend** is deployed via GitHub Actions on push to `main`. Requires the `CONVEX_DEPLOY_KEY` secret in the GitHub repo settings.

## API

Full API documentation: [docs/http-api.md](docs/http-api.md)

```
GET  /api/v1/skills          # list skills
GET  /api/v1/roles           # list roles
GET  /api/v1/search?q=...    # search skills and roles
POST /api/v1/skills          # publish skill (bearer token required)
POST /api/v1/roles           # publish role (bearer token required)
GET  /api/v1/whoami          # validate token
```

Authenticated endpoints require an `Authorization: Bearer <token>` header. Create tokens from the Settings page.

## Content Formats

### SKILL.md

```yaml
---
name: git-workflow
description: "Git branching and commit conventions"
---

# Git Workflow

Instructions for the agent...
```

### ROLE.md

Dependencies are declared in the frontmatter under `skills` and `roles` sub-keys. Version specifiers are optional.

```yaml
---
name: implementer
description: "Writes code to implement features and fix bugs"
dependencies:
  skills:
    - git-workflow>=1.0.0
    - code-review
    - python-testing^2.0.0
  roles:
    - reviewer
metadata:
  strawpot:
    default_model:
      provider: claude_session
      id: claude-opus-4-6
---

# Implementer

Role instructions for the agent...
```

### Dependency Version Specifiers

| Format | Meaning | Example |
|--------|---------|---------|
| `slug` | Latest version | `git-workflow` |
| `slug==X.Y.Z` | Exact version | `git-workflow==1.0.0` |
| `slug>=X.Y.Z` | Minimum version | `git-workflow>=1.0.0` |
| `slug^X.Y.Z` | Compatible (same major, >= specified) | `git-workflow^1.0.0` |

## Testing

```bash
# Unit tests
npm test

# Unit tests (CI, single run)
npm run test:ci

# E2E tests (builds app, runs Playwright)
npm run test:e2e

# Coverage
npm run coverage
```
